Multi threading maybe needs tested
